const translations = {
    "en": {
        "title": "Skin Type Survey",
        "main-title": "Skin Type Survey for Foreigners",
        "part1-title": "Part 1. Oil (O) vs Dry (D)",
        "q1-p1": "After washing your face and applying nothing, does your face feel tight?",
        "q1-p1-opt1": "① Never",
        "q1-p1-opt2": "② Sometimes",
        "q1-p1-opt3": "③ Often",
        "q1-p1-opt4": "④ Always severely",
        "q2-p1": "How much oil usually appears on your nose or forehead (T-zone)?",
        "q2-p1-opt1": "① A lot",
        "q2-p1-opt2": "② A little",
        "q2-p1-opt3": "③ Rarely",
        "q2-p1-opt4": "④ None at all",
        "q3-p1": "When you look in the mirror, what is the size of your pores?",
        "q3-p1-opt1": "① Very large",
        "q3-p1-opt2": "② Average",
        "q3-p1-opt3": "③ Small",
        "q3-p1-opt4": "④ Hardly visible",
        "q4-p1": "In the afternoon, does your makeup smudge or clump due to oil?",
        "q4-p1-opt1": "① Always",
        "q4-p1-opt2": "② Sometimes",
        "q4-p1-opt3": "③ Rarely",
        "q4-p1-opt4": "④ If I don't wear makeup, my skin cracks",
        "q5-p1": "Do you often experience dead skin cells on your face?",
        "q5-p1-opt1": "① Never",
        "q5-p1-opt2": "② Sometimes",
        "q5-p1-opt3": "③ Often",
        "q5-p1-opt4": "④ Very severe, appears white and flaky",

        "part2-title": "Part 2. Sensitive (S) vs Resistant (R)",
        "q1-p2": "When you change cosmetics, do you experience skin troubles or itching?",
        "q1-p2-opt1": "① Very often",
        "q1-p2-opt2": "② Sometimes",
        "q1-p2-opt3": "③ Rarely",
        "q1-p2-opt4": "④ Never",
        "q2-p2": "Does your face turn red when you drink alcohol or eat spicy food?",
        "q2-p2-opt1": "① Immediately turns red",
        "q2-p2-opt2": "② Slightly red",
        "q2-p2-opt3": "③ Hardly any change",
        "q2-p2-opt4": "④ Not at all",
        "q3-p2": "Does your skin sting after only 20 minutes in the sun without sunscreen?",
        "q3-p2-opt1": "① Very stingy",
        "q3-p2-opt2": "② Slightly stingy",
        "q3-p2-opt3": "③ So-so",
        "q3-p2-opt4": "④ Not at all",
        "q4-p2": "Do you have visible capillaries or redness on your face?",
        "q4-p2-opt1": "① Very severe",
        "q4-p2-opt2": "② Slightly visible",
        "q4-p2-opt3": "③ Hardly any",
        "q4-p2-opt4": "④ None at all",
        "q5-p2": "Have you ever suffered from skin conditions such as atopy or seborrheic dermatitis?",
        "q5-p2-opt1": "① Yes",
        "q5-p2-opt2": "② Suspected",
        "q5-p2-opt3": "③ No",
        "q5-p2-opt4": "④ Very healthy",

        "part3-title": "Part 3. Pigmented (P) vs Non-Pigmented (N)",
        "q1-p3": "Do brown marks always remain after acne or wounds?",
        "q1-p3-opt1": "① Always",
        "q1-p3-opt2": "② Sometimes",
        "q1-p3-opt3": "③ Rarely",
        "q1-p3-opt4": "④ Never",
        "q2-p3": "Do you have noticeable blemishes, freckles, or spots on your face?",
        "q2-p3-opt1": "① Very many",
        "q2-p3-opt2": "② Average",
        "q2-p3-opt3": "③ A few",
        "q2-p3-opt4": "④ Hardly any",
        "q3-p3": "Do you feel that spots are increasing compared to the past?",
        "q3-p3-opt1": "① Definitely",
        "q3-p3-opt2": "② I think so",
        "q3-p3-opt3": "③ Not sure",
        "q3-p3-opt4": "④ No",
        "q4-p3": "When exposed to sunlight, does your skin turn dark immediately rather than red?",
        "q4-p3-opt1": "① Yes",
        "q4-p3-opt2": "② Slightly",
        "q4-p3-opt3": "③ Turns red then tans",
        "q4-p3-opt4": "④ Only turns red",
        "q5-p3": "Is the skin color on your upper lip or cheekbones unbalanced?",
        "q5-p3-opt1": "① Very much so",
        "q5-p3-opt2": "② Slightly",
        "q5-p3-opt3": "③ Hardly any",
        "q5-p3-opt4": "④ Not at all",

        "part4-title": "Part 4. Wrinkles (W) vs Firmness (T)",
        "q1-p4": "Do you usually smoke or are you frequently exposed to passive smoking?",
        "q1-p4-opt1": "① Yes",
        "q1-p4-opt2": "② Used to",
        "q1-p4-opt3": "③ Very rarely",
        "q1-p4-opt4": "④ Not at all",
        "q2-p4": "When you smile, do fine lines remain around your eyes or mouth?",
        "q2-p4-opt1": "① Already deeply etched",
        "q2-p4-opt2": "② Fine lines are visible",
        "q2-p4-opt3": "③ Hardly any",
        "q2-p4-opt4": "④ None at all",
        "q3-p4": "Do you apply sunscreen daily (including indoors)?",
        "q3-p4-opt1": "① No",
        "q3-p4-opt2": "② Sometimes",
        "q3-p4-opt3": "③ Only when going out",
        "q3-p4-opt4": "④ Meticulously every day",
        "q4-p4": "If a pillow mark appears on your face, does it disappear quickly?",
        "q4-p4-opt1": "① Disappears very slowly",
        "q4-p4-opt2": "② Takes a while",
        "q4-p4-opt3": "③ Disappears quickly",
        "q4-p4-opt4": "④ No mark appears",
        "q5-p4": "Do you feel that your skin is losing elasticity and sagging?",
        "q5-p4-opt1": "① Very severe",
        "q5-p4-opt2": "② Feel it a little",
        "q5-p4-opt3": "③ Still fine",
        "q5-p4-opt4": "④ Very firm",
        "calculate-button": "Calculate Skin Type",
        "results-title": "Your Skin Type Result:",
        "result-p1": "Part 1: ",
        "result-p2": "Part 2: ",
        "result-p3": "Part 3: ",
        "result-p4": "Part 4: ",
        "overall-result": "Overall Skin Type: ",
        "skin-type-details-intro": "Below are the 16 Baumann skin type results. Find your 4-letter alphanumeric combination from the survey to check your results. It contains the characteristics and key management strategies for each type.",
        "alert-unanswered": "Please answer all questions before calculating your skin type.",
        "skinTypeDetails": {
            "OSPW": {
                "title": "OSPW (Most Demanding Type)",
                "characteristics": "This type has high sebum secretion, is sensitive, and is concerned about both blemishes and wrinkles. It requires very careful management, addressing anti-inflammatory care and anti-aging simultaneously.",
                "management": "Core Management: Anti-inflammatory care and anti-aging simultaneously."
            },
            "OSPT": {
                "title": "OSPT (Sensitive Acne-Prone Skin)",
                "characteristics": "This type has a lot of oil and frequent troubles, leaving scars (post-inflammatory hyperpigmentation) easily. Gentle soothing and brightening care are key.",
                "management": "Core Management: Gentle soothing and brightening care."
            },
            "OSNW": {
                "title": "OSNW (Rosacea-prone Oily Skin)",
                "characteristics": "This type has a lot of oil but few blemishes. However, the skin is very red, sensitive, and prone to wrinkles, requiring caution against 'heat aging'.",
                "management": "Core Management: Caution against 'heat aging'."
            },
            "OSNT": {
                "title": "OSNT (Typical Oily Sensitive)",
                "characteristics": "The skin is red and prone to troubles, but hyperpigmentation is less common. Focusing on oil-water balance and soothing care will quickly improve it.",
                "management": "Core Management: Oil-water balance and soothing care."
            },
            "ORPW": {
                "title": "ORPW (Healthy Oil Producer)",
                "characteristics": "The skin barrier is strong, so most cosmetics work well, but concerns are shine, blemishes, and wrinkles. It can tolerate strong ingredients like retinol.",
                "management": "Core Management: Can tolerate strong ingredients like retinol."
            },
            "ORPT": {
                "title": "ORPT (Smooth Oily Skin)",
                "characteristics": "The skin is strong and has few wrinkles, but oiliness and blemishes are concerns. Regular exfoliation and proper sunscreen application are sufficient.",
                "management": "Core Management: Regular exfoliation and proper sunscreen application."
            },
            "ORNW": {
                "title": "ORNW (Strong Oily Aging)",
                "characteristics": "No blemishes and healthy skin, but excessive oil and wrinkles are concerns. Focus on sebum control and elasticity care.",
                "management": "Core Management: Sebum control and elasticity care."
            },
            "ORNT": {
                "title": "ORNT (Most Ideal Oily Skin)",
                "characteristics": "The skin barrier is very strong and clear. If you just manage oiliness slightly, it's the best type to hear compliments like 'celebrity skin'.",
                "management": "Core Management: Slight oiliness management."
            },
            "DSPW": {
                "title": "DSPW (Very Vulnerable Dry Skin)",
                "characteristics": "Extremely dry, leading to a compromised barrier, with simultaneous blemishes and wrinkles. High-moisturizing nourishing cream and low-irritation care are essential.",
                "management": "Core Management: High-moisturizing nourishing cream and low-irritation care."
            },
            "DSPT": {
                "title": "DSPT (Dry Sensitive Pigmented)",
                "characteristics": "Due to dryness, the skin becomes sensitive, making blemishes appear more easily. Increasing skin defense through hydration is key.",
                "management": "Core Management: Increasing skin defense through hydration."
            },
            "DSNW": {
                "title": "DSNW (White Paper Skin)",
                "characteristics": "No blemishes, but the skin is too thin and dry, leading to deep wrinkles. Moisturizing and collagen management are very important.",
                "management": "Core Management: Moisturizing and collagen management."
            },
            "DSNT": {
                "title": "DSNT (Dry Sensitive Type)",
                "characteristics": "This dry type easily reddens due to thin skin. Gentle, moisturizing products are the answer rather than irritating functional products.",
                "management": "Core Management: Gentle, moisturizing products."
            },
            "DRPW": {
                "title": "DRPW (Strong Dry Blemished)",
                "characteristics": "The skin is healthy and resistant to irritation, but it's very dry with many spots and blemishes. Oil-type moisturizers and brightening products are effective.",
                "management": "Core Management: Oil-type moisturizers and brightening products."
            },
            "DRPT": {
                "title": "DRPT (Dry Pigmented Type)",
                "characteristics": "Resolving dryness will significantly improve skin condition. Provide sufficient hydration and partial blemish management.",
                "management": "Core Management: Sufficient hydration and partial blemish management."
            },
            "DRNW": {
                "title": "DRNW (Typical Aging Skin)",
                "characteristics": "The skin is relatively strong, so high-performance anti-aging products (like retinol) can be actively used. Moisturizing and wrinkle care are top priorities.",
                "management": "Core Management: Moisturizing and wrinkle care."
            },
            "DRNT": {
                "title": "DRNT (Pure Dry Skin)",
                "characteristics": "No blemishes and good elasticity, but always thirsty for moisture. Looks the prettiest, but if care is neglected, it quickly becomes rough.",
                "management": "Core Management: Don't neglect moisturizing care."
            }
        }
    },
    "ko": {
        "title": "피부 타입 설문조사",
        "main-title": "외국인을 위한 피부 타입 설문조사",
        "part1-title": "Part 1. 유분(O) vs 건조(D)",
        "q1-p1": "세안 후 아무것도 바르지 않았을 때, 얼굴이 당기는 느낌이 드나요?",
        "q1-p1-opt1": "①전혀 없다",
        "q1-p1-opt2": "②가끔 있다",
        "q1-p1-opt3": "③자주 느낀다",
        "q1-p1-opt4": "④항상 심하게 느낀다",
        "q2-p1": "평소 코나 이마(T존)에 기름기가 얼마나 생기나요?",
        "q2-p1-opt1": "①매우 많다",
        "q2-p1-opt2": "②약간 있다",
        "q2-p1-opt3": "③거의 없다",
        "q2-p1-opt4": "④아예 없다",
        "q3-p1": "거울을 봤을 때 모공의 크기는 어떤가요?",
        "q3-p1-opt1": "①매우 크다",
        "q3-p1-opt2": "②평범하다",
        "q3-p1-opt3": "③작은 편이다",
        "q3-p1-opt4": "④거의 보이지 않는다",
        "q4-p1": "오후가 되면 화장이 기름기에 지워지거나 뭉치나요?",
        "q4-p1-opt1": "①항상 그렇다",
        "q4-p1-opt2": "②가끔 그렇다",
        "q4-p1-opt3": "③별로 그렇지 않다",
        "q4-p1-opt4": "④화장을 안 하면 피부가 갈라진다",
        "q5-p1": "평소 피부에 각질이 자주 일어나나요?",
        "q5-p1-opt1": "①전혀 없다",
        "q5-p1-opt2": "②가끔 생긴다",
        "q5-p1-opt3": "③자주 일어난다",
        "q5-p1-opt4": "④매우 심해서 하얗게 뜬다",

        "part2-title": "Part 2. 민감성(S) vs 저항성(R)",
        "q1-p2": "화장품을 바꾸었을 때 피부에 트러블이나 가려움이 생기나요?",
        "q1-p2-opt1": "①매우 자주",
        "q1-p2-opt2": "②가끔",
        "q1-p2-opt3": "③거의 없다",
        "q1-p2-opt4": "④한 번도 없다",
        "q2-p2": "술을 마시거나 매운 음식을 먹으면 얼굴이 붉어지나요?",
        "q2-p2-opt1": "①즉시 붉어진다",
        "q2-p2-opt2": "②약간 붉어진다",
        "q2-p2-opt3": "③변화가 거의 없다",
        "q2-p2-opt4": "④전혀 없다",
        "q3-p2": "자외선 차단제 없이 햇빛을 20분만 쬐어도 피부가 따갑나요?",
        "q3-p2-opt1": "①매우 따갑다",
        "q3-p2-opt2": "②약간 따갑다",
        "q3-p2-opt3": "③그저 그렇다",
        "q3-p2-opt4": "④아무렇지 않다",
        "q4-p2": "피부에 실핏줄이 비쳐 보이거나 홍조가 있나요?",
        "q4-p2-opt1": "①매우 심하다",
        "q4-p2-opt2": "②약간 있다",
        "q4-p2-opt3": "③거의 없다",
        "q4-p2-opt4": "④전혀 없다",
        "q5-p2": "과거에 아토피, 지루성 피부염 등 피부 질환을 앓은 적이 있나요?",
        "q5-p2-opt1": "①그렇다",
        "q5-p2-opt2": "②의심된 적 있다",
        "q5-p2-opt3": "③없다",
        "q5-p2-opt4": "④매우 건강하다",

        "part3-title": "Part 3. 색소성(P) vs 비색소성(N)",
        "q1-p3": "여드름이나 상처가 난 자리에 갈색 자국이 남나요?",
        "q1-p3-opt1": "①항상 남는다",
        "q1-p3-opt2": "②가끔 남는다",
        "q1-p3-opt3": "③거의 남지 않는다",
        "q1-p3-opt4": "④전혀 남지 않는다",
        "q2-p3": "얼굴에 기미, 주근깨, 잡티가 눈에 띄게 있나요?",
        "q2-p3-opt1": "①매우 많다",
        "q2-p3-opt2": "②보통이다",
        "q2-p3-opt3": "③조금 있다",
        "q2-p3-opt4": "④거의 없다",
        "q3-p3": "과거에 비해 잡티가 점점 늘어난다고 느끼나요?",
        "q3-p3-opt1": "①확실히 그렇다",
        "q3-p3-opt2": "②그런 것 같다",
        "q3-p3-opt3": "③잘 모르겠다",
        "q3-p3-opt4": "④아니다",
        "q4-p3": "햇빛에 타면 피부가 붉어지기보다 바로 검게 변하나요?",
        "q4-p3-opt1": "①그렇다",
        "q4-p3-opt2": "②약간 그렇다",
        "q4-p3-opt3": "③붉어졌다가 탄다",
        "q4-p3-opt4": "④붉어지기만 한다",
        "q5-p3": "윗입술이나 광대 부위의 피부색이 불균형한가요?",
        "q5-p3-opt1": "①매우 그렇다",
        "q5-p3-opt2": "②약간 그렇다",
        "q5-p3-opt3": "③거의 없다",
        "q5-p3-opt4": "④전혀 없다",

        "part4-title": "Part 4. 주름(W) vs 탱탱함(T)",
        "q1-p4": "평소에 흡연을 하거나 간접흡연에 자주 노출되나요?",
        "q1-p4-opt1": "①그렇다",
        "q1-p4-opt2": "②과거에 했다",
        "q1-p4-opt3": "③아주 가끔",
        "q1-p4-opt4": "④전혀 안 한다",
        "q2-p4": "웃을 때 눈가나 입가에 잔주름이 남나요?",
        "q2-p4-opt1": "①이미 깊게 있다",
        "q2-p4-opt2": "②잔주름이 보인다",
        "q2-p4-opt3": "③거의 없다",
        "q2-p4-opt4": "④전혀 없다",
        "q3-p4": "자외선 차단제를 매일(실내 포함) 바르시나요?",
        "q3-p4-opt1": "①안 바른다",
        "q3-p4-opt2": "②가끔 바른다",
        "q3-p4-opt3": "③외출 시만 바른다",
        "q3-p4-opt4": "④매일 꼼꼼히 바른다",
        "q4-p4": "얼굴에 베개 자국이 생기면 금방 사라지나요?",
        "q4-p4-opt1": "①매우 늦게 사라진다",
        "q4-p4-opt2": "②조금 걸린다",
        "q4-p4-opt3": "③금방 사라진다",
        "q4-p4-opt4": "④자국이 안 생긴다",
        "q5-p4": "피부가 탄력 없이 처진다는 느낌을 받나요?",
        "q5-p4-opt1": "①매우 심하다",
        "q5-p4-opt2": "②조금 느낀다",
        "q5-p4-opt3": "③아직 괜찮다",
        "q5-p4-opt4": "④매우 탱탱하다",
        "calculate-button": "피부 타입 계산",
        "results-title": "당신의 피부 타입 결과:",
        "result-p1": "Part 1: ",
        "result-p2": "Part 2: ",
        "result-p3": "Part 3: ",
        "result-p4": "Part 4: ",
        "overall-result": "전체 피부 타입: ",
        "skin-type-details-intro": "바우만 피부 타입의 16가지 결과지를 정리해 드립니다. 설문을 통해 나온 4자리 알파벳 조합을 찾아 확인해 보세요. 각 타입의 특징과 핵심 관리 전략을 담았습니다.",
        "alert-unanswered": "피부 타입을 계산하기 전에 모든 질문에 답변해주세요.",
        "skinTypeDetails": {
            "OSPW": {
                "title": "OSPW (가장 까다로운 타입)",
                "characteristics": "피지 분비가 많고 예민하며 잡티와 주름 걱정이 모두 있는 타입입니다. 항염 관리와 노화 방지를 동시에 해야 하므로 매우 세심한 관리가 필요합니다.",
                "management": "핵심 관리: 항염 관리와 노화 방지를 동시에."
            },
            "OSPT": {
                "title": "OSPT (민감성 여드름 피부)",
                "characteristics": "유분이 많고 트러블이 잦으며 그 자리에 흉터(색소침착)가 잘 남습니다. 자극 없는 진정과 미백 관리가 핵심입니다.",
                "management": "핵심 관리: 자극 없는 진정과 미백 관리."
            },
            "OSNW": {
                "title": "OSNW (안면 홍조형 지성)",
                "characteristics": "기름기는 많지만 잡티는 적습니다. 다만 피부가 매우 붉고 예민하며 주름이 생기기 쉬워 '열 노화'를 주의해야 합니다.",
                "management": "핵심 관리: '열 노화' 주의."
            },
            "OSNT": {
                "title": "OSNT (전형적인 지성 민감성)",
                "characteristics": "피부가 붉고 트러블이 잘 생기지만 색소침착은 적은 편입니다. 유수분 밸런스와 진정에만 집중하면 금방 좋아집니다.",
                "management": "핵심 관리: 유수분 밸런스와 진정."
            },
            "ORPW": {
                "title": "ORPW (건강한 산유국)",
                "characteristics": "피부 장벽이 튼튼해서 웬만한 화장품은 다 잘 맞지만, 번들거림과 잡티, 주름이 고민입니다. 레티놀 같은 강력한 성분도 잘 받아들입니다.",
                "management": "핵심 관리: 레티놀 같은 강력한 성분도 잘 받아들임."
            },
            "ORPT": {
                "title": "ORPT (매끄러운 지성)",
                "characteristics": "피부가 튼튼하고 주름도 적지만 기름기와 잡티가 고민입니다. 정기적인 각질 제거와 선크림만 잘 발라도 충분합니다.",
                "management": "핵심 관리: 정기적인 각질 제거와 선크림."
            },
            "ORNW": {
                "title": "ORNW (튼튼한 지성 노화)",
                "characteristics": "잡티도 없고 피부도 건강하지만, 과도한 유분과 주름이 고민입니다. 피지 조절과 탄력 케어에 집중하세요.",
                "management": "핵심 관리: 피지 조절과 탄력 케어."
            },
            "ORNT": {
                "title": "ORNT (가장 이상적인 지성)",
                "characteristics": "피부 장벽이 매우 튼튼하고 투명합니다. 기름기만 살짝 잡아주면 연예인 피부 소리를 듣기 가장 좋은 타입입니다.",
                "management": "핵심 관리: 가벼운 기름기 관리."
            },
            "DSPW": {
                "title": "DSPW (매우 취약한 건성)",
                "characteristics": "너무 건조해서 장벽이 무너졌고, 그로 인해 잡티와 주름이 동시에 진행됩니다. 고보습 영양 크림과 저자극 관리가 필수입니다.",
                "management": "핵심 관리: 고보습 영양 크림과 저자극 관리."
            },
            "DSPT": {
                "title": "DSPT (건조한 민감 색소)",
                "characteristics": "건조함 때문에 피부가 예민해져 잡티가 더 잘 올라오는 타입입니다. 수분 공급을 통해 피부 방어력을 높여야 합니다.",
                "management": "핵심 관리: 수분 공급을 통한 피부 방어력 강화."
            },
            "DSNW": {
                "title": "DSNW (하얀 종이 피부)",
                "characteristics": "잡티는 없지만 피부가 너무 얇고 건조해서 주름이 깊게 생깁니다. 보습과 함께 콜라겐 관리가 매우 중요합니다.",
                "management": "핵심 관리: 보습과 콜라겐 관리."
            },
            "DSNT": {
                "title": "DSNT (건성 민감형)",
                "characteristics": "피부가 얇아 쉽게 붉어지는 건성 타입입니다. 자극적인 기능성 제품보다는 보습 위주의 순한 제품이 정답입니다.",
                "management": "핵심 관리: 보습 위주의 순한 제품."
            },
            "DRPW": {
                "title": "DRPW (튼튼한 건성 잡티)",
                "characteristics": "피부는 건강해서 자극에 강하지만 매우 건조하고 기미나 잡티가 많습니다. 오일 타입의 보습제와 미백 제품이 효과적입니다.",
                "management": "핵심 관리: 오일 타입 보습제와 미백 제품."
            },
            "DRPT": {
                "title": "DRPT (건성 색소형)",
                "characteristics": "건조함만 해결하면 피부 컨디션이 확 살아납니다. 보습을 충분히 하면서 부분적인 잡티 관리만 해주세요.",
                "management": "핵심 관리: 충분한 보습과 부분적인 잡티 관리."
            },
            "DRNW": {
                "title": "DRNW (전형적인 노화 피부)",
                "characteristics": "피부가 튼튼한 편이라 고기능성 안티에이징 제품(레티놀 등)을 적극적으로 써도 좋습니다. 보습과 주름 관리가 1순위입니다.",
                "management": "핵심 관리: 보습과 주름 관리."
            },
            "DRNT": {
                "title": "DRNT (청순한 건조 피부)",
                "characteristics": "잡티도 없고 탄력도 좋지만, 늘 수분이 배고픈 상태입니다. 겉보기에 가장 예뻐 보이지만 관리를 쉬면 금방 푸석해집니다.",
                "management": "핵심 관리: 꾸준한 보습 관리."
            }
        }
    }
};

let currentLang = localStorage.getItem('lang') || 'en';

const updateContent = (lang) => {
    document.querySelectorAll('[data-lang-key]').forEach(element => {
        const key = element.getAttribute('data-lang-key');
        if (translations[lang] && translations[lang][key]) {
            element.textContent = translations[lang][key];
        }
    });
};

const setupLanguageSwitcher = () => {
    const langBtns = document.querySelectorAll('.lang-btn');
    langBtns.forEach(btn => {
        btn.classList.remove('active');
        if (btn.getAttribute('data-lang') === currentLang) {
            btn.classList.add('active');
        }
        btn.addEventListener('click', () => {
            currentLang = btn.getAttribute('data-lang');
            localStorage.setItem('lang', currentLang);
            updateContent(currentLang);
            langBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        });
    });
};

const calculateResult = (partName, total) => {
    if (partName === 'part1') { // O vs D
        return total >= 10 ? 'O (Oily)' : 'D (Dry)';
    } else if (partName === 'part2') { // S vs R
        return total >= 10 ? 'S (Sensitive)' : 'R (Resistant)';
    } else if (partName === 'part3') { // P vs N
        return total >= 10 ? 'P (Pigmented)' : 'N (Non-Pigmented)';
    } else if (partName === 'part4') { // W vs T
        return total >= 10 ? 'W (Wrinkles)' : 'T (Firmness)';
    }
    return '';
};


document.addEventListener('DOMContentLoaded', () => {
    updateContent(currentLang);
    setupLanguageSwitcher();

    const form = document.getElementById('skin-survey-form');
    const resultsSection = document.getElementById('results');

    form.addEventListener('submit', (event) => {
        event.preventDefault();
        console.log('Form submitted!'); // 디버깅

        // Validation check for all questions
        const allQuestionsAnswered = Array.from(document.querySelectorAll('.survey-part')).every(part => {
            const radioButtons = part.querySelectorAll('input[type="radio"]');
            const questionNames = new Set();
            radioButtons.forEach(radio => questionNames.add(radio.name));
            
            return Array.from(questionNames).every(name => 
                part.querySelector(`input[name="${name}"]:checked`)
            );
        });

        console.log('All questions answered:', allQuestionsAnswered); // 디버깅

        if (!allQuestionsAnswered) {
            alert(translations[currentLang]["alert-unanswered"]);
            resultsSection.style.display = 'none'; // Hide results if validation fails
            document.getElementById('skin-type-details').style.display = 'none';
            return; // Stop the function
        }

        let p1Score = 0; // Oily/Sensitive/Pigmented/Wrinkles
        let p2Score = 0;
        let p3Score = 0;
        let p4Score = 0;

        // Part 1: Oil (O) vs Dry (D)
        // O is 1,2. D is 3,4. Score O by counting 1s and 2s.
        document.querySelectorAll('input[name^="q"][name$="-p1"]:checked').forEach(input => {
            const value = parseInt(input.value);
            if (value === 1 || value === 2) { // Based on the [계산] ①,②번이 많으면 O(지성) / ③,④번이 많으면 D(건성)
                p1Score += 1;
            }
        });
        const resultP1 = p1Score >= 3 ? 'O (Oily)' : 'D (Dry)'; // Assuming 3 or more is "many"


        // Part 2: Sensitive (S) vs Resistant (R)
        // S is 1,2. R is 3,4. Score S by counting 1s and 2s.
        document.querySelectorAll('input[name^="q"][name$="-p2"]:checked').forEach(input => {
            const value = parseInt(input.value);
            if (value === 1 || value === 2) { // Based on the [계산] ①,②번이 많으면 S(민감성) / ③,④번이 많으면 R(저항성)
                p2Score += 1;
            }
        });
        const resultP2 = p2Score >= 3 ? 'S (Sensitive)' : 'R (Resistant)'; // Assuming 3 or more is "many"


        // Part 3: Pigmented (P) vs Non-Pigmented (N)
        // P is 1,2. N is 3,4. Score P by counting 1s and 2s.
        document.querySelectorAll('input[name^="q"][name$="-p3"]:checked').forEach(input => {
            const value = parseInt(input.value);
            if (value === 1 || value === 2) { // Based on the [계산] ①,②번이 많으면 P(색소성) / ③,④번이 많으면 N(비색소성)
                p3Score += 1;
            }
        });
        const resultP3 = p3Score >= 3 ? 'P (Pigmented)' : 'N (Non-Pigmented)'; // Assuming 3 or more is "many"


        // Part 4: Wrinkles (W) vs Firmness (T)
        // W is 1,2. T is 3,4. Score W by counting 1s and 2s.
        document.querySelectorAll('input[name^="q"][name$="-p4"]:checked').forEach(input => {
            const value = parseInt(input.value);
            if (value === 1 || value === 2) { // Based on the [계산] ①,②번이 많으면 W(주름형) / ③,④번이 많으면 T(탱탱함)
                p4Score += 1;
            }
        });
        const resultP4 = p4Score >= 3 ? 'W (Wrinkles)' : 'T (Firmness)'; // Assuming 3 or more is "many"

        document.getElementById('result-p1-type').textContent = resultP1;
        document.getElementById('result-p2-type').textContent = resultP2;
        document.getElementById('result-p3-type').textContent = resultP3;
        document.getElementById('result-p4-type').textContent = resultP4;

        const overallSkinType = `${resultP1.charAt(0)}${resultP2.charAt(0)}${resultP3.charAt(0)}${resultP4.charAt(0)}`;
        console.log('Calculated skin type:', overallSkinType); // 디버깅
        document.getElementById('overall-skin-type').textContent = overallSkinType;

        const skinTypeDetailsIntroP = document.getElementById('skin-type-details-intro-p');
        if (skinTypeDetailsIntroP) {
            skinTypeDetailsIntroP.textContent = translations[currentLang]["skin-type-details-intro"];
        }

        const detailsTitle = document.getElementById('details-title');
        const detailsCharacteristics = document.getElementById('details-characteristics');
        const detailsManagement = document.getElementById('details-management');
        const skinTypeDetailDiv = document.getElementById('skin-type-details');

        if (translations[currentLang].skinTypeDetails && translations[currentLang].skinTypeDetails[overallSkinType]) {
            const detail = translations[currentLang].skinTypeDetails[overallSkinType];
            detailsTitle.textContent = detail.title;
            detailsCharacteristics.textContent = detail.characteristics;
            detailsManagement.textContent = detail.management;
            skinTypeDetailDiv.style.display = 'block';
        } else {
            detailsTitle.textContent = '';
            detailsCharacteristics.textContent = '';
            detailsManagement.textContent = '';
            skinTypeDetailDiv.style.display = 'none';
        }


        
        resultsSection.style.display = 'block';

        // 결과 섹션으로 부드럽게 스크롤
        setTimeout(() => {
            resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
    });
});